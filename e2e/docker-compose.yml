version: '3.8'

services:
  playwright:
    build:
      context: .
      dockerfile: Dockerfile
    networks:
      - testwebapp_default
    volumes:
      - .:/e2e
      - /e2e/node_modules
      - ./playwright-report:/e2e/playwright-report
      - ./test-results:/e2e/test-results
    environment:
      - CI=true
      - BASE_URL=http://frontend:3000
    working_dir: /e2e
    # Increase shared memory for browser stability
    shm_size: 2gb
    # Optimize DNS resolution
    dns:
      - 8.8.8.8
      - 8.8.4.4

networks:
  testwebapp_default:
    name: testwebapp_default
    external: true
